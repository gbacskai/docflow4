<div class="verify-page">
  <div class="auth-container">
    <div class="auth-header">
      <div class="verify-icon">
        <svg width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
          <path d="m9 12 2 2 4-4"></path>
          <path d="M21 12c0 4.97-4.03 9-9 9s-9-4.03-9-9 4.03-9 9-9c.394 0 .785.025 1.169.073"></path>
          <path d="M16 3h6v6"></path>
          <path d="m22 3-6 6"></path>
        </svg>
      </div>
      <h1>Verify Your Email</h1>
      <p class="auth-subtitle">
        @if (pendingEmail()) {
          We've sent a 6-digit verification code to <strong>{{ pendingEmail() }}</strong>
        } @else {
          Enter your email and the verification code we sent you
        }
      </p>
    </div>

    <div class="verify-form-container" data-test="verify-page">
      <form [formGroup]="verifyForm" (ngSubmit)="onVerify()" class="auth-form">
        <div class="form-group">
          <label for="verify-email">Email Address</label>
          <input
            id="verify-email"
            type="email"
            formControlName="email"
            placeholder="Enter your email address"
            [class.error]="verifyForm.get('email')?.invalid && verifyForm.get('email')?.touched"
            data-test="verify-email-input"
          />
          @if (verifyForm.get('email')?.invalid && verifyForm.get('email')?.touched) {
            <div class="error-message">
              @if (verifyForm.get('email')?.errors?.['required']) {
                Email is required
              }
              @if (verifyForm.get('email')?.errors?.['email']) {
                Please enter a valid email address
              }
            </div>
          }
        </div>

        <div class="form-group">
          <label for="verification-code">Verification Code</label>
          <input
            id="verification-code"
            type="text"
            formControlName="confirmationCode"
            placeholder="Enter 6-digit code"
            maxlength="6"
            [class.error]="verifyForm.get('confirmationCode')?.invalid && verifyForm.get('confirmationCode')?.touched"
            data-test="verify-code-input"
          />
          @if (verifyForm.get('confirmationCode')?.invalid && verifyForm.get('confirmationCode')?.touched) {
            <div class="error-message">
              Please enter a valid 6-digit verification code
            </div>
          }
          
          <div class="resend-section">
            <p class="resend-text">Didn't receive the code?</p>
            <button 
              type="button" 
              class="btn-secondary" 
              (click)="resendVerificationCode()" 
              [disabled]="processing()"
              data-test="resend-verification-code-btn"
            >
              {{ processing() ? 'Sending...' : 'Resend Code' }}
            </button>
          </div>
        </div>

        @if (errorMessage()) {
          <div class="alert alert-error" data-test="verify-error">{{ errorMessage() }}</div>
        }

        @if (successMessage()) {
          <div class="alert alert-success" data-test="verify-success">{{ successMessage() }}</div>
        }

        <button 
          type="submit" 
          class="btn-primary btn-full-width" 
          [disabled]="!verifyForm.valid || processing()"
          data-test="verify-submit-btn"
        >
          {{ processing() ? 'Verifying...' : 'Verify Email' }}
        </button>
      </form>

      <div class="auth-switch">
        <p>
          <button type="button" class="link-btn" (click)="navigateToLogin()" data-test="goto-login-btn">
            Back to Sign In
          </button>
          |
          <button type="button" class="link-btn" (click)="navigateToSignup()" data-test="goto-signup-btn">
            Create New Account
          </button>
        </p>
      </div>
    </div>

    <div class="verify-info">
      <h3>Email Verification</h3>
      <div class="info-content">
        <div class="info-item">
          <span class="info-icon">üìß</span>
          <div>
            <strong>Check Your Inbox</strong>
            <p>The verification code was sent to your email address. It may take a few minutes to arrive.</p>
          </div>
        </div>
        
        <div class="info-item">
          <span class="info-icon">üì±</span>
          <div>
            <strong>Check Spam/Junk</strong>
            <p>If you don't see the email in your inbox, please check your spam or junk folder.</p>
          </div>
        </div>
        
        <div class="info-item">
          <span class="info-icon">‚è∞</span>
          <div>
            <strong>Code Expires</strong>
            <p>Verification codes expire after 24 hours. Request a new code if needed.</p>
          </div>
        </div>
        
        <div class="info-item">
          <span class="info-icon">üîí</span>
          <div>
            <strong>Secure Process</strong>
            <p>This verification ensures your account security and email ownership.</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>